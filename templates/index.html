<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¨o Scraper - Anti Cloudflare</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>body { font-family: 'Inter', sans-serif; }</style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-4">

    <div class="max-w-4xl mx-auto bg-gray-800 rounded-xl shadow-2xl p-6">
        <h1 class="text-3xl font-bold text-center text-blue-400 mb-6">ğŸ•µï¸â€â™‚ï¸ TÃ¨o Scraper (VÆ°á»£t Cloudflare)</h1>
        
        <div class="space-y-6">
            
            <div>
                <label class="block text-sm font-bold text-blue-400 mb-2">ğŸ“ Link ChÆ°Æ¡ng Truyá»‡n</label>
                <input type="text" id="chapter_url" class="w-full p-3 rounded bg-gray-700 border border-gray-600 outline-none" placeholder="https://metruyencv.com/...">
            </div>

            <div class="bg-gray-700/50 p-4 rounded-lg border border-yellow-600/50">
                <h3 class="font-bold text-yellow-400 mb-3">ğŸ›  Cáº¥u hÃ¬nh VÆ°á»£t TÆ°á»ng Lá»­a (Báº¯t buá»™c)</h3>
                <p class="text-xs text-gray-400 mb-4">Äá»ƒ qua máº·t Cloudflare, báº¡n cáº§n cung cáº¥p cáº£ Cookie vÃ  User-Agent tá»« cÃ¹ng má»™t trÃ¬nh duyá»‡t.</p>

                <div class="mb-4">
                    <label class="block text-xs uppercase text-gray-300 font-bold mb-1">
                        BÆ°á»›c 1: User Agent (Dáº¥u vÃ¢n tay trÃ¬nh duyá»‡t)
                    </label>
                    <input type="text" id="user_agent" class="w-full p-2 rounded bg-gray-900 border border-gray-600 text-xs font-mono text-purple-400" placeholder="Paste User-Agent vÃ o Ä‘Ã¢y...">
                    <div class="mt-1 text-xs text-gray-500">
                        ğŸ‘‰ <b>CÃ¡ch láº¥y:</b> TrÃªn tab Ä‘ang Ä‘á»c truyá»‡n > Nháº¥n <b>F12</b> > Chá»n tab <b>Console</b> > GÃµ lá»‡nh <code>navigator.userAgent</code> rá»“i Enter > Copy chuá»—i Ä‘Ã³.
                    </div>
                </div>

                <div>
                    <label class="block text-xs uppercase text-gray-300 font-bold mb-1">
                        BÆ°á»›c 2: Cookie (ChÃ¬a khÃ³a Ä‘Äƒng nháº­p)
                    </label>
                    <textarea id="cookie_str" class="w-full h-20 p-2 rounded bg-gray-900 border border-gray-600 text-xs font-mono text-green-400" placeholder="Paste toÃ n bá»™ dÃ²ng Cookie vÃ o Ä‘Ã¢y..."></textarea>
                    <div class="mt-1 text-xs text-gray-500">
                        ğŸ‘‰ <b>CÃ¡ch láº¥y:</b> F12 > Tab <b>Network</b> > F5 > Chá»n dÃ²ng Ä‘áº§u tiÃªn (tÃªn web) > Copy dÃ²ng <b>Cookie</b> bÃªn pháº£i.
                    </div>
                </div>
            </div>

            <button onclick="startScrape()" id="btn-run" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded-lg transition shadow-lg">
                ğŸš€ Báº¯t Ä‘áº§u HÃºt & Dá»‹ch
            </button>
            
            <div id="status" class="hidden text-center text-yellow-400 font-mono text-sm mt-2 animate-pulse">
                â³ Äang giáº£ danh & vÆ°á»£t Cloudflare... (Chá» khoáº£ng 2 phÃºt)...
            </div>
        </div>

        <div class="mt-8">
            <h2 class="text-xl font-bold mb-2">ğŸ“„ Káº¿t quáº£:</h2>
            <textarea id="result_area" class="w-full h-96 bg-black p-4 rounded border border-gray-700 font-mono text-sm text-gray-300" readonly></textarea>
        </div>
    </div>

    <script>
        async function startScrape() {
            const btn = document.getElementById('btn-run');
            const status = document.getElementById('status');
            const resultArea = document.getElementById('result_area');

            const data = {
                chapter_url: document.getElementById('chapter_url').value,
                cookie_str: document.getElementById('cookie_str').value,
                user_agent: document.getElementById('user_agent').value,
            };

            if (!data.chapter_url || !data.cookie_str || !data.user_agent) {
                alert("Thiáº¿u thÃ´ng tin! Pháº£i nháº­p Ä‘á»§ Link, Cookie vÃ  User-Agent Ä‘á»ƒ vÆ°á»£t Cloudflare.");
                return;
            }

            btn.disabled = true;
            btn.classList.add('opacity-50');
            status.classList.remove('hidden');
            resultArea.value = "Äang xá»­ lÃ½...";

            try {
                const response = await fetch('/process', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const json = await response.json();
                resultArea.value = json.result || json.error;
            } catch (e) {
                resultArea.value = "Lá»—i káº¿t ná»‘i: " + e;
            } finally {
                btn.disabled = false;
                btn.classList.remove('opacity-50');
                status.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
